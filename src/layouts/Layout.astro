---
import SubmitTalkModal from '../components/SubmitTalkModal.astro';

interface Props {
  title: string;
  description?: string;
}

const { title, description = "A collection of Flutter talks from conferences and events around the world" } = Astro.props;
const baseUrl = import.meta.env.BASE_URL;

// Christmas Detection Logic (Dec 1st to Jan 15th)
const now = new Date();
const month = now.getMonth();
const day = now.getDate();
const isChristmas = (month === 11) || (month === 0 && day <= 15);

const logoImage = isChristmas ? "flutter-talks-logo-cristmass.png" : "flutter-talks-logo.png";

// Fetch GitHub Stars
let stars = 0;
try {
  const response = await fetch('https://api.github.com/repos/daveragos/flutter_talks');
  const data = await response.json();
  stars = data.stargazers_count || 0;
} catch (e) {
  console.error('Failed to fetch stars', e);
}
---



<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <link rel="apple-touch-icon" sizes="180x180" href={`${baseUrl}favicon/apple-touch-icon.png`}>
    <link rel="icon" type="image/png" sizes="32x32" href={`${baseUrl}favicon/favicon-32x32.png`}>
    <link rel="icon" type="image/png" sizes="16x16" href={`${baseUrl}favicon/favicon-16x16.png`}>
    <link rel="manifest" href={`${baseUrl}favicon/site.webmanifest`}>

    <meta name="generator" content={Astro.generator} />
    <title>{title}</title>
    <meta name="description" content={description} />
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
  </head>
  <body class="min-h-screen bg-background text-foreground font-sans flex flex-col selection:bg-primary/30">
    <header class="sticky top-0 z-50 bg-background/80 backdrop-blur-md border-b border-border/50">
      <nav class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
        <div class="flex justify-between items-center">
          <a href={baseUrl} class="flex items-center group transition-transform hover:scale-105">
            <img
              src={`${baseUrl}images/${logoImage}`}
              alt="Flutter Talks"
              class="h-16 w-auto"
            />
          </a>
          <div class="space-x-6 flex items-center">
            {isChristmas && (
              <div class="hidden md:flex items-center gap-1 text-primary animate-pulse mr-4 select-none pointer-events-none" aria-hidden="true">
                <span class="text-xs">❄️</span>
                <span class="text-[10px] font-bold uppercase tracking-[0.2em] opacity-50">Merry Flutter</span>
                <span class="text-xs">❄️</span>
              </div>
            )}
            <a href={baseUrl} class="text-sm font-medium text-muted-foreground hover:text-primary transition-colors">Home</a>
            <a href={`${baseUrl}contribute/`} class="text-sm font-medium text-muted-foreground hover:text-primary transition-colors">Contribute</a>
            <a href="https://github.com/daveragos/flutter_talks" target="_blank" rel="noopener noreferrer" class="flex items-center gap-1.5 text-muted-foreground hover:text-primary transition-colors group">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5"><path d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4"/><path d="M9 18c-4.51 2-5-2-7-2"/></svg>
              {stars > 0 && (
                <span class="flex items-center gap-0.5 px-1.5 py-0.5 rounded-full bg-secondary text-[10px] font-bold text-foreground group-hover:bg-primary/20 group-hover:text-primary transition-colors">
                  <svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 24 24" fill="currentColor" stroke="none" class="text-yellow-500"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.87L12 17.77l-6.18 3.24L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                  {stars}
                </span>
              )}
            </a>

          </div>
        </div>
      </nav>
      {isChristmas && (
        <div class="absolute inset-x-0 -bottom-px h-px bg-gradient-to-r from-transparent via-primary/50 to-transparent"></div>
      )}
    </header>


    <main class="flex-grow max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12 w-full">
      <slot />
    </main>
    <footer class="border-t border-border/50 bg-card/30 py-8 mt-auto">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
        <p class="text-sm text-muted-foreground">
          © {new Date().getFullYear()} Flutter Talks. Built with ❤️ by <a href="https://github.com/daveragos" target="_blank" rel="noopener noreferrer" class="text-primary hover:underline font-medium">Dave RaGoose</a>
        </p>
      </div>
    </footer>
    <SubmitTalkModal githubRepo="daveragos/flutter_talks" githubBranch="main" />
  </body>

</html>